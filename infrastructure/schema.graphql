type Room {
  id: ID!
  code: String!
  hostId: String!
  mediaType: MediaType!
  genreIds: [Int!]!
  candidates: [MovieCandidate!]!
  createdAt: AWSDateTime!
}

type MovieCandidate {
  id: Int!
  title: String!
  overview: String!
  posterPath: String
  releaseDate: String
  mediaType: MediaType!
}

type Match {
  id: ID!
  roomId: String!
  movieId: Int!
  title: String!
  posterPath: String
  timestamp: AWSDateTime!
  matchedUsers: [String!]!
}

type Vote {
  roomId: String!
  userId: String!
  movieId: Int!
  vote: Boolean!
}

enum MediaType {
  MOVIE
  TV
}

type Mutation {
  createRoom(input: CreateRoomInput!): Room!
  joinRoom(code: String!): Room!
  vote(input: VoteInput!): VoteResult!
  createMatch(input: CreateMatchInput!): Match!
}

input CreateMatchInput {
  roomId: String!
  movieId: Int!
  title: String!
  posterPath: String
  matchedUsers: [String!]!
}

type Query {
  getRoom(id: String!): Room
  getMyRooms: [Room!]!
  getMyMatches: [Match!]!
  checkRoomMatch(roomId: String!): Match
  checkUserMatches: [Match!]!
}

type Subscription {
  onMatchCreated: Match
    @aws_subscribe(mutations: ["createMatch"])
}

input CreateRoomInput {
  mediaType: MediaType!
  genreIds: [Int!]!
}

input VoteInput {
  roomId: String!
  movieId: Int!
  vote: Boolean!
}

type VoteResult {
  success: Boolean!
  match: Match
}

schema {
  query: Query
  mutation: Mutation
  subscription: Subscription
}